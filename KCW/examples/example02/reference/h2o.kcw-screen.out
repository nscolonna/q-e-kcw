
     =--------------------------------------------------------------------------------=
                      :::    :::           ::::::::         :::       ::: 
                     :+:   :+:           :+:    :+:        :+:       :+:  
                    +:+  +:+            +:+               +:+       +:+   
                   +#++:++             +#+               +#+  +:+  +#+    
                  +#+  +#+            +#+               +#+ +#+#+ +#+     
                 #+#   #+#           #+#    #+#         #+#+# #+#+#       
                ###    ###           ########           ###   ###         

       Koopmans functional implementation based on DFPT; please cite this program as

        N.Colonna, R. De Gennaro, E. Linscott, and N. Marzari, JCTC 18, 5435 (2022) 

                                                                                    

       If you use the non-collinear mode (with/without spin-orbit coupling) please cite

        A. Marrazzo and N. Colonna, Phys. Rev. Research 6, 033085 (2024)  
     =--------------------------------------------------------------------------------=

     Program KCW v.7.3.1 starts on 25Sep2024 at 15:17:16 
        Git branch: develop
        Last git commit: bdd82480539e9b5a8a2317b314f3e3ce005b4fba-dirty
        Last git commit date: Sat Sep 21 21:24:12 2024 +0000
        Last git commit subject: Merge branch 'XClib_some_updates' into 'develop'

     This program is part of the open-source Quantum ESPRESSO suite
     for quantum simulation of materials; please cite
         "P. Giannozzi et al., J. Phys.:Condens. Matter 21 395502 (2009);
         "P. Giannozzi et al., J. Phys.:Condens. Matter 29 465901 (2017);
         "P. Giannozzi et al., J. Chem. Phys. 152 154105 (2020);
          URL http://www.quantum-espresso.org", 
     in publications or presentations arising from this work. More details at
     http://www.quantum-espresso.org/quote

     Parallel version (MPI), running on     4 processors

     MPI processes distributed on     1 nodes
     R & G space division:  proc/nbgrp/npool/nimage =       4
     204158 MiB available memory on the printing compute node when the environment starts
 

     KCW INPUT SUMMARY 
     ============================================

      CONTROL 
       # title               =    KCW h2o screen
       # out_dir             =/home/colonna_n/CO
       # prefix              =               h2o
       # calculation         =            screen
       # kcw_iverbosity      =                 2
       # kcw_at_ks           =                 T
       # MP grid             =     1     1     1
       # spin_component      =                 1
       # homo_only           =                 F
       # read_unitary_matrix =                 F
       # check_ks            =                 F
       # l_vcut              =                 F
       # assume_isolated     =                mt
       # io_sp               =                 F
       # io_real_space       =                 F

      SCREEN 
       # lrpa                =                 F
       # fix_orb             =                 F
       # tr2                 =        0.1000E-17
       # niter               =                33
       # nmix                =                 4
       # eps_inf             =        0.1000E+01
       # check_spread        =                 F
     ============================================

     INFO: Reading pwscf data

     Reading xml data from directory:

     /home/colonna_n/CODES/q-e-kcw/tempdir/h2o.save/

     IMPORTANT: XC functional enforced from input :
     Exchange-correlation= PBE
                           (   1   4   3   4   0   0   0)
     Any further DFT definition will be discarded
     Please, verify this is what you really want

 
     Parallelization info
     --------------------
     sticks:   dense  smooth     PW     G-vecs:    dense   smooth      PW
     Min         975     975    244                44983    44983    5620
     Max         977     977    245                44984    44984    5623
     Sum        3905    3905    979               179933   179933   22489
 
     Using Slab Decomposition
 

     Check: negative core charge=   -0.000035
     Reading collected, re-writing distributed wavefunctions

     INFO: Buffer for KS wfcs, OPENED

     INFO: Buffer for WF rho, OPENED

     INFO: Coulomb kernel treated according to MT scheme

     INFO: READING Wannier-orbital Densities ...

        ==============================================================================
        iq =     1
        The  Wannier density at  q =    0.0000000   0.0000000   0.0000000  [Cart ]
        The  Wannier density at  q =    0.0000000   0.0000000   0.0000000  [Cryst]
        ==============================================================================

     INFO: total number of wannier to compute    8 from     1 to     8

     INFO: PREPARING THE KCW CALCULATION ... DONE




     INFO: LR CALCULATION ...


     ==============================================================================
     Calculation of q =    0.0000000   0.0000000   0.0000000  [Cart ]
     Calculation of q =    0.0000000   0.0000000   0.0000000  [Cryst]
     ==============================================================================

        INFO: prepare_q DONE

        INFO: rhowan_q(r) RETRIEVED

        INFO: kcw_q initialization DONE

        DEBUG: \int dr [rho - rho_PWSCF] =       0.510796E-18

weight =    1  1.00000000
      ADDING Martyna-Tuckerman correction


        Start linear response calculation for the wannier #  1    spin =  1

      iter #   1 total cpu time :     1.7 secs   av.it.:  16.5
      thresh= 1.000E-06 alpha_mix =  0.700 |ddv_scf|^2 =  1.004E-08

      iter #   2 total cpu time :     2.3 secs   av.it.:  17.0
      thresh= 1.000E-06 alpha_mix =  0.700 |ddv_scf|^2 =  6.453E-09

      iter #   3 total cpu time :     2.9 secs   av.it.:  16.0
      thresh= 8.033E-07 alpha_mix =  0.700 |ddv_scf|^2 =  1.797E-10

      iter #   4 total cpu time :     3.6 secs   av.it.:  16.0
      thresh= 1.340E-07 alpha_mix =  0.700 |ddv_scf|^2 =  3.339E-12

      iter #   5 total cpu time :     4.2 secs   av.it.:  16.0
      thresh= 1.827E-08 alpha_mix =  0.700 |ddv_scf|^2 =  1.135E-13

      iter #   6 total cpu time :     4.9 secs   av.it.:  15.5
      thresh= 3.369E-09 alpha_mix =  0.700 |ddv_scf|^2 =  4.915E-16

      iter #   7 total cpu time :     5.5 secs   av.it.:  16.5
      thresh= 2.217E-10 alpha_mix =  0.700 |ddv_scf|^2 =  9.623E-17

      iter #   8 total cpu time :     6.2 secs   av.it.:  16.5
      thresh= 9.810E-11 alpha_mix =  0.700 |ddv_scf|^2 =  1.616E-18

      iter #   9 total cpu time :     6.8 secs   av.it.:  15.5
      thresh= 1.271E-11 alpha_mix =  0.700 |ddv_scf|^2 =  4.741E-20

        iq =   1   iwann =   1   rPi_q =     0.89794453     0.00000000   rPi_q_RS =     0.89794455     0.00000000   uPi_q =     1.41629405     0.00000000   Self Hartree =     0.77038230     0.00000000
      ADDING Martyna-Tuckerman correction


        Start linear response calculation for the wannier #  2    spin =  1

      iter #   1 total cpu time :     7.4 secs   av.it.:  16.0
      thresh= 1.000E-06 alpha_mix =  0.700 |ddv_scf|^2 =  6.903E-09

      iter #   2 total cpu time :     8.0 secs   av.it.:  17.0
      thresh= 8.309E-07 alpha_mix =  0.700 |ddv_scf|^2 =  3.937E-09

      iter #   3 total cpu time :     8.7 secs   av.it.:  16.0
      thresh= 6.275E-07 alpha_mix =  0.700 |ddv_scf|^2 =  1.720E-10

      iter #   4 total cpu time :     9.3 secs   av.it.:  16.0
      thresh= 1.312E-07 alpha_mix =  0.700 |ddv_scf|^2 =  1.940E-12

      iter #   5 total cpu time :     9.9 secs   av.it.:  16.0
      thresh= 1.393E-08 alpha_mix =  0.700 |ddv_scf|^2 =  2.376E-14

      iter #   6 total cpu time :    10.6 secs   av.it.:  15.5
      thresh= 1.541E-09 alpha_mix =  0.700 |ddv_scf|^2 =  3.051E-16

      iter #   7 total cpu time :    11.2 secs   av.it.:  16.0
      thresh= 1.747E-10 alpha_mix =  0.700 |ddv_scf|^2 =  3.222E-17

      iter #   8 total cpu time :    11.9 secs   av.it.:  16.5
      thresh= 5.676E-11 alpha_mix =  0.700 |ddv_scf|^2 =  1.664E-18

      iter #   9 total cpu time :    12.5 secs   av.it.:  16.0
      thresh= 1.290E-11 alpha_mix =  0.700 |ddv_scf|^2 =  3.289E-20

        iq =   1   iwann =   2   rPi_q =     0.84166409     0.00000000   rPi_q_RS =     0.84166410     0.00000000   uPi_q =     1.18820008     0.00000000   Self Hartree =     0.66941946     0.00000000
      ADDING Martyna-Tuckerman correction


        Start linear response calculation for the wannier #  3    spin =  1

      iter #   1 total cpu time :    13.1 secs   av.it.:  16.0
      thresh= 1.000E-06 alpha_mix =  0.700 |ddv_scf|^2 =  9.068E-09

      iter #   2 total cpu time :    13.8 secs   av.it.:  17.0
      thresh= 9.523E-07 alpha_mix =  0.700 |ddv_scf|^2 =  6.163E-09

      iter #   3 total cpu time :    14.4 secs   av.it.:  16.0
      thresh= 7.851E-07 alpha_mix =  0.700 |ddv_scf|^2 =  1.470E-10

      iter #   4 total cpu time :    15.0 secs   av.it.:  16.0
      thresh= 1.212E-07 alpha_mix =  0.700 |ddv_scf|^2 =  1.247E-13

      iter #   5 total cpu time :    15.7 secs   av.it.:  16.0
      thresh= 3.531E-09 alpha_mix =  0.700 |ddv_scf|^2 =  1.648E-14

      iter #   6 total cpu time :    16.3 secs   av.it.:  16.0
      thresh= 1.284E-09 alpha_mix =  0.700 |ddv_scf|^2 =  1.114E-15

      iter #   7 total cpu time :    17.0 secs   av.it.:  16.0
      thresh= 3.337E-10 alpha_mix =  0.700 |ddv_scf|^2 =  6.123E-17

      iter #   8 total cpu time :    17.6 secs   av.it.:  16.5
      thresh= 7.825E-11 alpha_mix =  0.700 |ddv_scf|^2 =  2.740E-18

      iter #   9 total cpu time :    18.2 secs   av.it.:  16.0
      thresh= 1.655E-11 alpha_mix =  0.700 |ddv_scf|^2 =  7.455E-20

        iq =   1   iwann =   3   rPi_q =     0.81570996     0.00000000   rPi_q_RS =     0.81570998     0.00000000   uPi_q =     1.27038408     0.00000000   Self Hartree =     0.71960754     0.00000000
      ADDING Martyna-Tuckerman correction


        Start linear response calculation for the wannier #  4    spin =  1

      iter #   1 total cpu time :    18.8 secs   av.it.:  16.0
      thresh= 1.000E-06 alpha_mix =  0.700 |ddv_scf|^2 =  9.650E-09

      iter #   2 total cpu time :    19.5 secs   av.it.:  17.0
      thresh= 9.823E-07 alpha_mix =  0.700 |ddv_scf|^2 =  6.392E-09

      iter #   3 total cpu time :    20.1 secs   av.it.:  16.0
      thresh= 7.995E-07 alpha_mix =  0.700 |ddv_scf|^2 =  1.669E-10

      iter #   4 total cpu time :    20.8 secs   av.it.:  16.0
      thresh= 1.292E-07 alpha_mix =  0.700 |ddv_scf|^2 =  7.770E-13

      iter #   5 total cpu time :    21.5 secs   av.it.:  16.0
      thresh= 8.815E-09 alpha_mix =  0.700 |ddv_scf|^2 =  9.953E-14

      iter #   6 total cpu time :    22.1 secs   av.it.:  15.5
      thresh= 3.155E-09 alpha_mix =  0.700 |ddv_scf|^2 =  4.310E-16

      iter #   7 total cpu time :    22.7 secs   av.it.:  16.0
      thresh= 2.076E-10 alpha_mix =  0.700 |ddv_scf|^2 =  9.241E-17

      iter #   8 total cpu time :    23.4 secs   av.it.:  16.0
      thresh= 9.613E-11 alpha_mix =  0.700 |ddv_scf|^2 =  3.148E-18

      iter #   9 total cpu time :    24.0 secs   av.it.:  15.5
      thresh= 1.774E-11 alpha_mix =  0.700 |ddv_scf|^2 =  2.065E-19

        iq =   1   iwann =   4   rPi_q =     0.79946687     0.00000000   rPi_q_RS =     0.79946689     0.00000000   uPi_q =     1.26918017     0.00000000   Self Hartree =     0.71815300     0.00000000
      ADDING Martyna-Tuckerman correction


        Start linear response calculation for the wannier #  5    spin =  1

      iter #   1 total cpu time :    24.6 secs   av.it.:  14.0
      thresh= 1.000E-06 alpha_mix =  0.700 |ddv_scf|^2 =  2.483E-10

      iter #   2 total cpu time :    25.2 secs   av.it.:  16.0
      thresh= 1.576E-07 alpha_mix =  0.700 |ddv_scf|^2 =  1.629E-11

      iter #   3 total cpu time :    25.9 secs   av.it.:  17.0
      thresh= 4.036E-08 alpha_mix =  0.700 |ddv_scf|^2 =  2.695E-11

      iter #   4 total cpu time :    26.5 secs   av.it.:  16.0
      thresh= 5.192E-08 alpha_mix =  0.700 |ddv_scf|^2 =  1.709E-14

      iter #   5 total cpu time :    27.1 secs   av.it.:  16.0
      thresh= 1.307E-09 alpha_mix =  0.700 |ddv_scf|^2 =  2.010E-15

      iter #   6 total cpu time :    27.8 secs   av.it.:  15.5
      thresh= 4.483E-10 alpha_mix =  0.700 |ddv_scf|^2 =  6.578E-17

      iter #   7 total cpu time :    28.5 secs   av.it.:  15.5
      thresh= 8.110E-11 alpha_mix =  0.700 |ddv_scf|^2 =  6.836E-18

      iter #   8 total cpu time :    29.1 secs   av.it.:  16.5
      thresh= 2.615E-11 alpha_mix =  0.700 |ddv_scf|^2 =  1.611E-19

        iq =   1   iwann =   5   rPi_q =     0.15726416    -0.00000000   rPi_q_RS =     0.15726416    -0.00000000   uPi_q =     0.16586372     0.00000000   Self Hartree =     0.16149347    -0.00000000
      ADDING Martyna-Tuckerman correction


        Start linear response calculation for the wannier #  6    spin =  1

      iter #   1 total cpu time :    29.7 secs   av.it.:  14.0
      thresh= 1.000E-06 alpha_mix =  0.700 |ddv_scf|^2 =  1.571E-10

      iter #   2 total cpu time :    30.3 secs   av.it.:  16.0
      thresh= 1.253E-07 alpha_mix =  0.700 |ddv_scf|^2 =  2.234E-11

      iter #   3 total cpu time :    31.0 secs   av.it.:  17.0
      thresh= 4.727E-08 alpha_mix =  0.700 |ddv_scf|^2 =  1.553E-11

      iter #   4 total cpu time :    31.6 secs   av.it.:  16.0
      thresh= 3.941E-08 alpha_mix =  0.700 |ddv_scf|^2 =  1.682E-14

      iter #   5 total cpu time :    32.3 secs   av.it.:  16.5
      thresh= 1.297E-09 alpha_mix =  0.700 |ddv_scf|^2 =  2.704E-15

      iter #   6 total cpu time :    32.9 secs   av.it.:  16.0
      thresh= 5.200E-10 alpha_mix =  0.700 |ddv_scf|^2 =  5.283E-17

      iter #   7 total cpu time :    33.6 secs   av.it.:  16.0
      thresh= 7.269E-11 alpha_mix =  0.700 |ddv_scf|^2 =  1.034E-17

      iter #   8 total cpu time :    34.2 secs   av.it.:  16.5
      thresh= 3.215E-11 alpha_mix =  0.700 |ddv_scf|^2 =  8.226E-20

        iq =   1   iwann =   6   rPi_q =     0.05650845    -0.00000000   rPi_q_RS =     0.05650846    -0.00000000   uPi_q =     0.06441130    -0.00000000   Self Hartree =     0.16108455    -0.00000000
      ADDING Martyna-Tuckerman correction


        Start linear response calculation for the wannier #  7    spin =  1

      iter #   1 total cpu time :    34.8 secs   av.it.:  14.0
      thresh= 1.000E-06 alpha_mix =  0.700 |ddv_scf|^2 =  1.913E-10

      iter #   2 total cpu time :    35.4 secs   av.it.:  16.0
      thresh= 1.383E-07 alpha_mix =  0.700 |ddv_scf|^2 =  1.556E-11

      iter #   3 total cpu time :    36.0 secs   av.it.:  17.0
      thresh= 3.945E-08 alpha_mix =  0.700 |ddv_scf|^2 =  2.133E-11

      iter #   4 total cpu time :    36.7 secs   av.it.:  16.0
      thresh= 4.618E-08 alpha_mix =  0.700 |ddv_scf|^2 =  3.708E-14

      iter #   5 total cpu time :    37.3 secs   av.it.:  16.0
      thresh= 1.926E-09 alpha_mix =  0.700 |ddv_scf|^2 =  2.530E-15

      iter #   6 total cpu time :    38.0 secs   av.it.:  16.0
      thresh= 5.030E-10 alpha_mix =  0.700 |ddv_scf|^2 =  3.025E-17

      iter #   7 total cpu time :    38.6 secs   av.it.:  15.5
      thresh= 5.500E-11 alpha_mix =  0.700 |ddv_scf|^2 =  4.898E-18

      iter #   8 total cpu time :    39.2 secs   av.it.:  16.5
      thresh= 2.213E-11 alpha_mix =  0.700 |ddv_scf|^2 =  1.196E-19

        iq =   1   iwann =   7   rPi_q =     0.05747290    -0.00000000   rPi_q_RS =     0.05747290    -0.00000000   uPi_q =     0.06408979     0.00000000   Self Hartree =     0.15902774    -0.00000000
      ADDING Martyna-Tuckerman correction


        Start linear response calculation for the wannier #  8    spin =  1

      iter #   1 total cpu time :    39.8 secs   av.it.:  13.0
      thresh= 1.000E-06 alpha_mix =  0.700 |ddv_scf|^2 =  1.331E-10

      iter #   2 total cpu time :    40.4 secs   av.it.:  14.0
      thresh= 1.154E-07 alpha_mix =  0.700 |ddv_scf|^2 =  1.107E-11

      iter #   3 total cpu time :    41.0 secs   av.it.:  16.0
      thresh= 3.327E-08 alpha_mix =  0.700 |ddv_scf|^2 =  2.350E-12

      iter #   4 total cpu time :    41.7 secs   av.it.:  16.0
      thresh= 1.533E-08 alpha_mix =  0.700 |ddv_scf|^2 =  4.462E-15

      iter #   5 total cpu time :    42.3 secs   av.it.:  16.0
      thresh= 6.680E-10 alpha_mix =  0.700 |ddv_scf|^2 =  5.442E-16

      iter #   6 total cpu time :    42.9 secs   av.it.:  16.0
      thresh= 2.333E-10 alpha_mix =  0.700 |ddv_scf|^2 =  1.080E-17

      iter #   7 total cpu time :    43.6 secs   av.it.:  15.5
      thresh= 3.287E-11 alpha_mix =  0.700 |ddv_scf|^2 =  1.125E-18

      iter #   8 total cpu time :    44.2 secs   av.it.:  16.5
      thresh= 1.061E-11 alpha_mix =  0.700 |ddv_scf|^2 =  5.874E-20

        iq =   1   iwann =   8   rPi_q =    -0.08137022    -0.00000000   rPi_q_RS =    -0.08137022    -0.00000000   uPi_q =    -0.08014452    -0.00000000   Self Hartree =     0.15729739     0.00000000


     INFO: LR CALCULATION ... DONE





        iwann  =     1   relaxed =      0.89794453   unrelaxed =      1.41629405   alpha =  0.63400996   self Hartree =  0.77038230

        iwann  =     2   relaxed =      0.84166409   unrelaxed =      1.18820008   alpha =  0.70835215   self Hartree =  0.66941946

        iwann  =     3   relaxed =      0.81570996   unrelaxed =      1.27038408   alpha =  0.64209712   self Hartree =  0.71960754

        iwann  =     4   relaxed =      0.79946687   unrelaxed =      1.26918017   alpha =  0.62990810   self Hartree =  0.71815300

        iwann  =     5   relaxed =      0.15726416   unrelaxed =      0.16586372   alpha =  0.94815287   self Hartree =  0.16149347

        iwann  =     6   relaxed =      0.05650845   unrelaxed =      0.06441130   alpha =  0.87730651   self Hartree =  0.16108455

        iwann  =     7   relaxed =      0.05747290   unrelaxed =      0.06408979   alpha =  0.89675591   self Hartree =  0.15902774

        iwann  =     8   relaxed =     -0.08137022   unrelaxed =     -0.08014452   alpha =  1.01529358   self Hartree =  0.15729739




 
     KCW          :     42.04s CPU     44.21s WALL

     INITIALIZATION: 
 
     init_vloc    :      0.05s CPU      0.05s WALL (       1 calls)
     init_us_1    :      0.00s CPU      0.00s WALL (       1 calls)
 
     solve_linter :     40.96s CPU     42.97s WALL (       8 calls)
 
     solve_linter :     40.96s CPU     42.97s WALL (       8 calls)
     ortho        :      0.04s CPU      0.04s WALL (     136 calls)
     cgsolve      :     23.14s CPU     23.37s WALL (     136 calls)
     incdrhoscf   :      1.33s CPU      1.39s WALL (     136 calls)
                                        0.00s GPU  (     136 calls)
     dv_of_drho   :     13.06s CPU     13.83s WALL (      68 calls)
     mix_pot      :      1.11s CPU      1.94s WALL (      68 calls)
 
 
     cgsolve      :     23.14s CPU     23.37s WALL (     136 calls)
     ch_psi       :     22.24s CPU     22.47s WALL (    2632 calls)
 
     ch_psi       :     22.24s CPU     22.47s WALL (    2632 calls)
     h_psi        :     19.99s CPU     20.18s WALL (    2632 calls)
     last         :      1.65s CPU      1.66s WALL (    2632 calls)
 
     h_psi        :     19.99s CPU     20.18s WALL (    2632 calls)
     add_vuspsi   :      0.80s CPU      0.81s WALL (    2632 calls)
 
     incdrhoscf   :      1.33s CPU      1.39s WALL (     136 calls)
                                        0.00s GPU  (     136 calls)
 
 
      General routines
     calbec       :      0.85s CPU      0.86s WALL (    2632 calls)
     fft          :      1.88s CPU      2.03s WALL (    1318 calls)
     ffts         :      0.10s CPU      0.11s WALL (      80 calls)
     fftw         :     11.39s CPU     11.56s WALL (   19930 calls)
     davcio       :      0.27s CPU      0.79s WALL (    1110 calls)
 
 
     KCW          :     42.04s CPU     44.22s WALL

 
   This run was terminated on:  15:18: 1  25Sep2024            

=------------------------------------------------------------------------------=
   JOB DONE.
=------------------------------------------------------------------------------=
